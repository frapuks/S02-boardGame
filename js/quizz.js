const Quizz = {
    database : [
        {
            question: "Quelle mer borde la ville de Sébastopol ?",
            solution: "la mer Noire",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est l'âge du capitaine ?",
            solution: "63",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quelle est le nom de la meilleure musique de tous les temps ?",
            solution: "Viva la vida",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit :  Je vais faire un < p >",
            solution: "Fabien",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : let va nous permettre de ne pas confondre Michel qui plante des arbres et michel le pyromane",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Double cote, ou simple cote, je dirais qu'à partir du moment ou c'est entrecote c'est bon",
            solution: "Sion",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Wie heißt die Mutter von Niki Lauda ?",
            solution: "Mama Laudaaa",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Si on te dit Olivier Vinot, à quel outil penses tu ?",
            solution: "PowerToys",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est le poids moyen d'une baleine bleue (en grammes) ?",
            solution: "140000000",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : C'est brumeux et j'entends des corbeaux. Deux salles deux ambiances ! ?",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Array c'est tableau mais en Americain ?",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est le prix d'une Renault Clio 1.0 TCe 90ch Evolution neuve (en euros) ?",
            solution: "21250",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Combien de vie(s) a un chat ?",
            solution: "1",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est le nom du premier ordinateur ?",
            solution: "ENIAC",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est le village alsacien avec le nom le plus long ?",
            solution: "Mittelschaeffolsheim",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Trouvez la bonne réponse a cette question !!!",
            solution: "42",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Comment savoir si le tube cathodique est mort ?",
            solution: "Le symptôme est que l'appareil ne s'allume plus à tous les coups, ou qu'une led clignote indiquant un défaut. Dans ce cas, les condensateurs de filtrage de l'alimentation ne filtrent plus correctement la tension de sortie.",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel est le plus beau meuble chez Adrien Blanc ?",
            solution: "la bibliothèque",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "true + false = ?",
            solution: "1",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "typeof NaN",
            solution: "number",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : il se trouve que 5 est égale à 4 +1",
            solution: "Sion",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Certes le quizz est content, mais nos fruits commencent à pourrir",
            solution: "Sion",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Qui a répondu à Adrien Blanc : bon ben vous n'avez pas besoin nous, je vous souhaites bonne continuation !!!",
            solution: "Pôle emploi",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Y'en a qui aime bien avec des barriere sur une piste de boowling et d'autre un bac a sable ou on peut aller nord sud est ouest !",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : j'ai rien contre, mais porter un costard j'ai du mal !",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : C'est les @freeze qui donne froid",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : J'essaye pas forcément d'écrire du code qui a du sens",
            solution: "Sion",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Les bourdons go dormir, c'est Octobre !",
            solution: "Guillaume",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
        {
            question: "Quel prof a dit : Ca va faire un pavé cesar, tout ceux qui vont te lire te salue",
            solution: "Sion",
            reponseUtilisateur: "Non répondu",
            resultat : "FAUX",
        },
    ],
    bonnesReponses : "",
    mauvaisesReponses : "",
    boardResultQuizz : document.querySelector('.boardResultQuizz'),
    divResultQuizz : document.querySelector('.resultQuizz'),
    nombreDeQuestions : 0,
    partyCounter : 0,

    startQuizz : function() {
        do {
            let nombreDeQuestionsString = prompt(`Combien de questions souhaitez vous entre 1 et ${Quizz.database.length} ?`);
            if (nombreDeQuestionsString === null) {
                break;
            }
            Quizz.nombreDeQuestions = parseInt(nombreDeQuestionsString);
        } while (Quizz.nombreDeQuestions < 1 || Quizz.nombreDeQuestions > Quizz.database.length || isNaN(Quizz.nombreDeQuestions));
        
        Quizz.bonnesReponses = 0;
        Quizz.mauvaisesReponses = 0;
        Quizz.partyCounter++;
        // mélange du tableau pour poser les questions dans un ordre aléatoire
        Quizz.database.sort(() => Math.random() - 0.5);
        
        for (let i = 0; i < Quizz.nombreDeQuestions; i++) {
            let question = Quizz.database[i];
            let reponse = prompt(question.question);
            // gestion du bouton annuler
            if (reponse === null){
                break;
            }
            Quizz.checkReponse(reponse, question);
            question.reponseUtilisateur = reponse;
        }
        Quizz.alertResultat();
        Quizz.displayResultat();
        Quizz.displayScore();
    },

    checkReponse : function(reponse, question) {
        if (reponse === question.solution) {
            Quizz.bonnesReponses++;
            question.resultat = "VRAI"
        } else {
            Quizz.mauvaisesReponses++;
        }
    },

    alertResultat : function() {
        if (Quizz.mauvaisesReponses === 0 && Quizz.bonnesReponses === 0) {
            alert(`Vous n'avez répondu à aucune questions`);
        } else if (Quizz.mauvaisesReponses === 0) {
            alert(`Vous avez ${Quizz.bonnesReponses} bonnes réponses, tout est juste`);
        } else if (Quizz.bonnesReponses === 0) {
            alert(`Vous avez ${Quizz.mauvaisesReponses} mauvaises réponses, tout est faux`);
        } else {
            alert(`Vous avez ${Quizz.bonnesReponses} bonnes réponses, et ${Quizz.mauvaisesReponses} mauvaises réponses`);
        }

        // let array = [];
        // for (let i = 0; i < Quizz.nombreDeQuestions; i++) {
        //     array.push(Quizz.database[i]['question']);
        //     array.push(Quizz.database[i]['solution']);
        //     array.push(Quizz.database[i]['reponseUtilisateur']);
        //     array.push(Quizz.database[i]['resultat']);
        // }
        // alert(array);
    },

    displayResultat : function() {
        Quizz.divResultQuizz.innerHTML = "";
        for (let i = 0; i < Quizz.nombreDeQuestions; i++) {
            let question = Quizz.database[i];
            let numeroQuestion = i + 1;
            let questionContainer = document.createElement("div");
            let headerQuestion = document.createElement("div");
            let mainQuestion = document.createElement("div");
            let footerQuestion = document.createElement("div");
            let spacingQuestion = document.createElement("div");
    
            headerQuestion.textContent = `Question ${numeroQuestion} : ${question.resultat}`;
    
            mainQuestion.textContent = `${question.question}`;
    
            footerQuestion.textContent = `Solution : ${question.solution} / Votre réponse : ${question.reponseUtilisateur}`;
    
            spacingQuestion.textContent = "___";
    
            questionContainer.appendChild(headerQuestion);
            questionContainer.appendChild(mainQuestion);
            questionContainer.appendChild(footerQuestion);
            questionContainer.appendChild(spacingQuestion);
            Quizz.divResultQuizz.appendChild(questionContainer);
        }
    },

    displayScore : function() {
        // doit afficher les scores dans le tableau

        let rowScore = document.createElement('tr');
        let cellPartyNumber = document.createElement('td');
        cellPartyNumber.textContent = Quizz.partyCounter;

        let cellScore = document.createElement('td');
        cellScore.textContent = Quizz.bonnesReponses;

        let cellNombreDeQuestions = document.createElement('td');
        cellNombreDeQuestions.textContent = Quizz.nombreDeQuestions;
    
        rowScore.appendChild(cellPartyNumber);
        rowScore.appendChild(cellNombreDeQuestions);
        rowScore.appendChild(cellScore);
        Quizz.boardResultQuizz.appendChild(rowScore);
    },
};

// TODO
// Gestion de la fonction displayscore